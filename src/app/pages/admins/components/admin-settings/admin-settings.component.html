<form [formGroup]="form" (ngSubmit)="onSubmit(form.value,form.valid)" novalidate>
    <div class="main-content">
        <div class="container-fluid">
            <div class="row">

                <div fxLayout="row" *ngIf="isLoading" fxLayoutAlign="space-around center"
                    style="height:100%; position: relative; margin-left: 50%; margin-right: 50%;">
                    <mat-spinner diameter="50" strokeWidth="5"></mat-spinner>
                </div>

                <div class="offset-xl-1 col-xl-10" *ngIf="!isLoading">
                    <h3 class="card-title">
                        {{getLang('general settings', 'General Settings')}}
                    </h3>

                    <div class="alert alert-danger d-none">
                        <span><b>{{getLang('yoursetupisnotcomplete', 'Your Setup is not complete')}} </b></span>
                    </div>

                    <div class="card">
                        <div class="card-body">
                            <div class="row">
                                <div class="offset-xl-1 col-xl-10">
                                    <h4 class="card-title">
                                        {{getLang('company details', 'Company Details')}}
                                    </h4>
                                    <div class="row">
                                        <div class="col-sm-6">
                                            <label class="col-form-label">
                                                {{getLang('brnchname', 'Company Name')}}
                                                <span class="text-danger">*</span>
                                            </label>
                                            <mat-form-field class="example-full-width">
                                                <input matInput name="branchname" type="text"
                                                    formControlName="branchname">
                                            </mat-form-field>
                                            <div [hidden]="form.get('branchname').valid || (form.get('branchname').pristine && !submitted)"
                                                class="text-danger">
                                                <small *ngIf="form.get('branchname').hasError('required')"
                                                    class="error-label">
                                                    {{getLang('branchnameisrequired', 'Branchname is Required')}}
                                                </small>
                                            </div>
                                        </div>
                                         <!-- hide START -->
                                        <div class="col-sm-6 d-none">
                                            <label class="col-form-label">
                                                {{getLang('bussinesseuvatnumber', 'Business EU VAT Number')}}
                                            </label>
                                            <mat-form-field class="example-full-width">
                                                <input matInput name="companyname" type="text"
                                                    formControlName="vatnumber">
                                            </mat-form-field>
                                        </div>
                                        <div class="col-sm-6 d-none">
                                            <label class="col-form-label">
                                                {{getLang('brnchphone', 'Company Phone')}}
                                            </label>
                                            <mat-form-field class="example-full-width">
                                                <input matInput type="number" formControlName="companyphone">
                                            </mat-form-field>
                                            <div [hidden]="form.get('companyphone').valid || (form.get('companyphone').pristine && !submitted)"
                                                class="text-danger">
                                                <small
                                                    *ngIf="form.get('companyphone').hasError('onlyvalidmobilenumber')"
                                                    class="error-label">
                                                    {{getLang('invalidcomponyphone', 'Invalid Company Phone')}}
                                                </small>
                                            </div>
                                        </div>
                                        <!-- hide END -->
                                        <div class="col-sm-6">
                                            <label class="col-form-label">
                                                {{getLang('logo', 'Logo')}}
                                            </label>
                                            <div class="row">
                                                <div class="col-sm-12">
                                                    <div class="fileinput fileinput-new text-center" rel="tooltip"
                                                        data-placement="bottom" data-toggle="tooltip"
                                                        title="Click To Upload or Change">
                                                        <label class="fileinput-new thumbnail" for="fileupload" style="cursor: pointer;">
                                                            <img class="img" id="branch_picture"  [src]="defaultlogo ? defaultlogo : '../../assets/img/image_placeholder.jpg'" />
                                                        </label>
                                                        <div class="add-photo-main">
                                                            <i class="material-icons cursor-pointer">cloud_upload</i>
                                                            <input type="file" id="fileupload" #fileInput ng2FileSelect
                                                                [style.display]="'none'" [uploader]="uploader"
                                                                accept=".jpg,.jpeg,.png,.bmp" />
                                                        </div>
                                                    </div>
                                                    <div class="file" *ngIf="response['file']" id="upload_status">
                                                        <div class="status">
                                                            {{langVisibility && langResource['uploading'] ?
                                                            langResource['uploading'] : 'Uploading'}}...
                                                            {{response.progress}}%
                                                        </div>
                                                        <div class="progress progress-line-primary">
                                                            <div class="progress-bar" role="progressbar"
                                                                attr.aria-valuenow="{{response.progress}}"
                                                                attr.aria-valuemin="0" attr.aria-valuemax="100"
                                                                style="width: 30%;">
                                                                <span class="sr-only">{{response.progress}}%
                                                                    {{langVisibility && langResource['complete'] ?
                                                                    langResource['complete'] : 'Complete'}}
                                                                </span>
                                                            </div>
                                                        </div>
                                                    </div>

                                                </div>
                                            </div>

                                        </div>
                                    </div>
                                </div>
                            </div>


                        </div>
                    </div>

                    <div class="card">
                        <div class="card-body">
                            <div class="row">
                                <div class="offset-xl-1 col-xl-10">
                                    <h4 class="card-title">
                                        {{getLang('company address', 'Company Address')}}
                                    </h4>

                                <app-dynamic-property-fields
                                        *ngIf="visible"
                                        [formid]="this.formObj._id"
                                        [myForm]="this.form"
                                        [mySubmitted]="this.isSubmitted"
                                        [bindIdData]="_propertyobjectModel">
                                  </app-dynamic-property-fields>

                                    <!-- <div class="row">
                                        <div class="col-sm-6">
                                            <label class="col-form-label">
                                                {{getLang('contactperson', 'Contact Person')}}
                                                <span class="text-danger">*</span>
                                            </label>
                                            <mat-form-field class="example-full-width">
                                                <input matInput name="contactperson" type="text"
                                                    formControlName="contactperson">
                                            </mat-form-field>
                                        </div>
                                        <div class="col-sm-6">
                                            <label class="col-form-label">
                                                {{getLang('address', 'Address')}}
                                                <span class="text-danger">*</span>
                                            </label>
                                            <mat-form-field class="example-full-width">
                                                <input matInput name="address" type="text" formControlName="address">
                                            </mat-form-field>
                                        </div>
                                        <div class="col-sm-6">
                                            <label class="col-form-label">
                                                {{getLang('postcode', 'Postcode')}}
                                            </label>
                                            <mat-form-field class="example-full-width">
                                                <input matInput name="postcode" type="text" formControlName="postcode">
                                            </mat-form-field>
                                        </div>
                                        <div class="col-sm-6">
                                            <label class="col-form-label">
                                                {{getLang('city', 'City')}}
                                            </label>
                                            <mat-form-field class="example-full-width">
                                                <input matInput name="city" type="text" formControlName="city">
                                            </mat-form-field>
                                        </div>
                                        <div class="col-sm-6">
                                            <label class="col-form-label">
                                                {{getLang('country', 'Country')}}
                                                <span class="text-danger">*</span>
                                            </label>

                                            <dynamic-autocomplete *ngIf="country_fields.visibility"
                                                [formControlName]="country_fields.fieldname" [setting]="country_fields"
                                                [dbvalue]="country_fields.dbvalue">
                                            </dynamic-autocomplete>

                                            <div [hidden]="form.get('country').valid || (form.get('country').pristine && !submitted)"
                                                class="text-danger">
                                                <small *ngIf="form.get('country').hasError('required')"
                                                    class="error-label">
                                                    {{getLang('countryrequired', 'Country required')}}
                                                </small>
                                            </div>

                                        </div>
                                    </div> -->
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-body">
                            <div class="row">
                                <div class="offset-xl-1 col-xl-10">
                                    <h4 class="card-title">
                                        {{getLang('general settings', 'General Settings')}}
                                    </h4>
                                    <div class="row">
                                        <div class="col-sm-6">
                                            <label class="col-form-label">
                                                {{getLang('select timezone', 'Select Timezone')}}
                                                <span class="text-danger">*</span>
                                            </label>
                                            <dynamic-autocomplete *ngIf="timezone_fields.visibility"
                                                [formControlName]="timezone_fields.fieldname"
                                                [setting]="timezone_fields" [dbvalue]="timezone_fields.dbvalue">
                                            </dynamic-autocomplete>

                                            <div [hidden]="form.get('timezone').valid || (form.get('timezone').pristine && !submitted)"
                                                class="text-danger">
                                                <small *ngIf="form.get('timezone').hasError('required')"
                                                    class="error-label">
                                                    {{getLang('timezonerequired', 'Timezone required')}}
                                                </small>
                                            </div>
                                        </div>

                                        <div class="col-sm-6">
                                            <label class="col-form-label">
                                                {{getLang('currency', 'Currency')}}
                                                <span class="text-danger">*</span>
                                            </label>

                                            <dynamic-autocomplete *ngIf="currency_fields.visibility"
                                                [formControlName]="currency_fields.fieldname"
                                                [setting]="currency_fields" [dbvalue]="currency_fields.dbvalue">
                                            </dynamic-autocomplete>

                                            <div [hidden]="form.get('currency').valid || (form.get('currency').pristine && !submitted)"
                                                class="text-danger">
                                                <small *ngIf="form.get('currency').hasError('required')"
                                                    class="error-label">
                                                    {{getLang('currencyrequired', 'Currency required')}}
                                                </small> 
                                            </div>
                                        </div>

                                        <div class="col-sm-6">
                                            <label class="col-form-label">
                                                {{getLang('locale', 'Locale')}}
                                                <span class="text-danger">*</span>
                                            </label>

                                            <dynamic-autocomplete *ngIf="locale_fields.visibility"
                                                [formControlName]="locale_fields.fieldname"
                                                [setting]="locale_fields" [dbvalue]="locale_fields.dbvalue">
                                            </dynamic-autocomplete>

                                            <div [hidden]="form.get('locale').valid || (form.get('locale').pristine && !submitted)"
                                                class="text-danger">
                                                <small *ngIf="form.get('locale').hasError('required')"
                                                    class="error-label">
                                                    {{getLang('localerequired', 'Locale required')}}
                                                </small> 
                                            </div>
                                        </div>



                                        <div class="col-sm-6" [ngClass]="allowmemberlogin == true  ? 'd-block' : 'd-none'">
                                            <label class="col-form-label">
                                                {{getLang('starting number', 'Starting Number')}}
                                            </label>
                                            <mat-form-field class="example-full-width">
                                                <input
                                                    matInput
                                                    name="startingnumber"
                                                    placeholder="Example: AAAA10001"
                                                    rel="tooltip"
                                                    data-placement="right"
                                                    data-toggle="tooltip"
                                                    title="Note:This is Starting Number for Member Number according to above Format."
                                                    formControlName="startingnumber">
                                            </mat-form-field>
                                        </div>

                                        <div class="col-sm-6">
                                            <label class="col-form-label">
                                                {{getLang('supportemail', 'Support Email')}}
                                            </label>
                                            <mat-form-field class="example-full-width">
                                                <input matInput type="email" formControlName="supportemail">
                                            </mat-form-field>
                                            <div [hidden]="form.get('supportemail').valid || (form.get('supportemail').pristine && !submitted)"
                                                class="text-danger">
                                                <small *ngIf="form.get('supportemail').hasError('email')"
                                                    class="error-label">
                                                    {{getLang('invalidemail', 'Invalid email')}}
                                                </small>
                                            </div>
                                        </div>

                                        <div class="col-sm-6">
                                            <label class="col-form-label">
                                                {{getLang('supportnumber', 'Support Phone')}}
                                            </label>
                                            <mat-form-field class="example-full-width">
                                                <input matInput type="number" formControlName="supportnumber">
                                            </mat-form-field>
                                            <div [hidden]="form.get('supportnumber').valid || (form.get('supportnumber').pristine && !submitted)"
                                                class="text-danger">
                                                <small
                                                    *ngIf="form.get('supportnumber').hasError('onlyvalidmobilenumber')"
                                                    class="error-label">
                                                    {{getLang('invalidnumber', 'Invalid number')}}
                                                </small>
                                            </div>
                                        </div>
                                        <div class="col-sm-6">
                                            <label class="col-form-label">
                                                {{getLang('workinghours', 'Working Hours')}}
                                                <span class="text-danger">*</span>
                                            </label>
                                            <div class="row">
                                                <div class="col-sm-6 col-md-6">
                                                    <mat-form-field class="example-full-width">
                                                        <input matInput type="time"  placeholder="Start Time" formControlName="starttime">
                                                        <mat-hint>{{getLang('fromhh/mm', 'From HH / MM')}}</mat-hint>
                                                    </mat-form-field>
                                                </div>
                                                <div class="col-sm-6 col-md-6">
                                                    <mat-form-field class="example-full-width">
                                                        <input matInput type="time" #targetendtime (focus)="focusFunction('endtime')" placeholder="End Time" formControlName="endtime">
                                                        <mat-hint>{{getLang('tohh/mm', 'To HH / MM')}}</mat-hint>
                                                    </mat-form-field>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-sm-6">
                                            <label class="col-form-label">
                                                {{getLang('working days', 'Working Days')}}
                                            </label>
                                            <div class="mt-2 row">
                                                <div class="col-12">
                                                    <section class="example-section row">
                                                        <mat-checkbox class="example-margin m-0 col-12"
                                                                (change)="$event ? setAllDays($event.checked) : null"
                                                                [checked]="isAllSelected()"
                                                                [indeterminate]="!isAllSelected()">
                                                           <span class="font-bold">{{getLang('selectall', 'Select All')}}</span>
                                                        </mat-checkbox>
                                                    </section>

                                                    <section class="example-section row">
                                                        <mat-checkbox class="example-margin m-0 col-md-4 col-6"
                                                            [(ngModel)]="day.checked" *ngFor="let day of wdoptions"
                                                            [ngModelOptions]="{standalone: true}">
                                                            {{day?.value}}
                                                        </mat-checkbox>
                                                    </section>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-sm-12">
                                            <div class="d-flex mb-2">
                                                <div class="flex-grow-1">
                                                    <label class="col-form-label pt-0"> {{getLang('breaktime', 'Break time')}} </label>
                                                </div>
                                                <div>
                                                    <a class="btn btn-link m-0 p-0 font-16 d-flex align-items-center"
                                                        href="#" data-toggle="modal" data-target="#myModal3">
                                                        <i class="material-icons mr-1">add</i>
                                                        {{getLang('addbreak', 'Add break')}}
                                                    </a>
                                                </div>
                                            </div>
                                            <div class="table-responsive">
                                                <table mat-table [dataSource]="breakList"
                                                    class="mat-elevation-z8 w-100 table-hover table-membroz">

                                                    <ng-container matColumnDef="title">
                                                        <th mat-header-cell *matHeaderCellDef> {{getLang('name',
                                                            'Name')}} </th>
                                                        <td mat-cell *matCellDef="let element"> {{element?.title}}
                                                        </td>
                                                    </ng-container>
                                                    <ng-container matColumnDef="days">
                                                        <th mat-header-cell *matHeaderCellDef> {{getLang('days',
                                                            'Days')}} </th>
                                                        <td mat-cell *matCellDef="let element"> {{element.days &&
                                                            element.days.length >
                                                            0 ? element.days.join(',') : ''}}
                                                        </td>
                                                    </ng-container>

                                                    <ng-container matColumnDef="starttime">
                                                        <th mat-header-cell *matHeaderCellDef> {{getLang('starttime',
                                                            'Start Time')}} </th>
                                                        <td mat-cell *matCellDef="let element"> {{element?.starttime}}
                                                        </td>
                                                    </ng-container>

                                                    <ng-container matColumnDef="endtime">
                                                        <th mat-header-cell *matHeaderCellDef> {{getLang('endtime', 'End Time')}} </th>
                                                        <td mat-cell *matCellDef="let element"> {{element?.endtime}}
                                                        </td>
                                                    </ng-container>
                                                    <ng-container matColumnDef="action">
                                                        <th mat-header-cell *matHeaderCellDef class="text-right">
                                                            {{getLang('action', 'Action')}}
                                                        </th>
                                                        <td mat-cell *matCellDef="let element ; let i = index;"
                                                            class="text-right">

                                                            <button type="button" (click)="onRemoveBreak(i)"
                                                                class="btn btn-link btn-primary btn-just-icon"
                                                                matTooltip="Delete" [matTooltipPosition]="'above'">
                                                                <i class="material-icons">delete</i>
                                                            </button>
                                                        </td>
                                                    </ng-container>
                                                    <tr mat-header-row *matHeaderRowDef="displayedColumns2"></tr>
                                                    <tr mat-row *matRowDef="let row; columns: displayedColumns2;"></tr>
                                                </table>
                                            </div>

                                        </div>

                                        <!-- <div class="col-sm-6" *ngIf="allowmemberlogin">
                                            <label class="col-form-label">
                                                {{getLang('walletenable', 'Wallet Setting')}}
                                            </label>
                                            <div class="mt-2">
                                                <section class="example-section">
                                                    <mat-checkbox class="example-margin" id="iswalletenable"
                                                        type="checkbox" name="iswalletenable"
                                                        formControlName="iswalletenable">
                                                        {{getLang('iswalletenable',
                                                        'Is Wallet Enable')}}
                                                    </mat-checkbox>
                                                </section>
                                            </div>
                                        </div> -->

                                        <div class="col-sm-3">
                                            <label class="col-form-label">
                                                {{getLang('qrenable', 'QR Setting')}} 
                                            </label>
                                            <div class="mt-2">
                                                <section class="example-section">
                                                    <mat-checkbox class="example-margin" formControlName="isqrenable"
                                                        (ngModelChange)="generateQR($event)" id="isqrenable"
                                                        type="checkbox" name="isqrenable"
                                                        [value]="_branchModel.isqrenable">
                                                        {{getLang('isqrenable', 'Is QR Enable')}}
                                                    </mat-checkbox>
                                                </section>
                                            </div>
                                            <div class="row" *ngIf="qrcode">
                                                <div class="col-sm-12">  
                                                    <a href="javascript:void(0)" (click)="printBtn('qrcode')">
                                                        <div id="qrcode" >                                                         
                                                             <img  *ngIf="qrcode" class="img printqrcode" [src]="qrcode"  />                                                         
                                                        </div>
                                                    </a> 
                                                </div>
                                            </div>
                                        </div>
                                        <!-- <div class="col-sm-3">
                                            <label class="col-form-label" style="padding: 16px;">
                                                
                                            </label>
                                            <div class="mt-2">
                                                <section class="example-section">
                                                    <mat-checkbox class="example-margin" formControlName="iswebqrenable"
                                                        (ngModelChange)="generateWebQR($event)" id="iswebqrenable"
                                                        type="checkbox" name="iswebqrenable"
                                                        [value]="_branchModel.iswebqrenable">
                                                        {{getLang('isqrenable', 'Is QR Enable(Web)')}}
                                                    </mat-checkbox>
                                                </section>
                                            </div>
                                            <div class="row" *ngIf="webqrcode">
                                                <div class="col-sm-12">
                                                    <a href="javascript:void(0)" (click)="printBtn('webqrcode')">
                                                        <div id="webqrcode">
                                                        <img  *ngIf="webqrcode" class="img printqrcode" [src]="webqrcode" />
                                                    </div>
                                                    </a>
                                                </div>
                                            </div>
                                        </div> -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>
    <footer class="footer fixed-bottom bg-white shadow-top" *ngIf="!isLoading">
        <div class="container-fluid">
            <div class="row">
                <div class="offset-xl-1 col-xl-10">
                    <div class="row">
                        <div class="col-sm-12 text-right">
                            <button class="btn btn-primary ml-2" type="submit" [disabled]="btnDisable">
                                <i class="material-icons">save</i>{{getLang('save', 'Save')}}
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </footer>
</form>






<div class="modal fade" id="myModal3" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <form [formGroup]="brform" (ngSubmit)="onSubmitBreak(brform.value,brform.valid)" novalidate>
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title"> {{getLang('addbreak', 'Add Break')}} </h4>
                    <button id="closebrk" mat-button type="button" class="close" data-dismiss="modal" aria-hidden="true"
                        (click)="brform.reset()">
                        <i class="material-icons">clear</i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-3">
                            <label class="col-form-label">
                                {{getLang('title', 'Title')}} <span class="text-danger">*</span>
                            </label>
                            <mat-form-field class="example-full-width">
                                <input matInput formControlName="title" placeholder="Title">
                            </mat-form-field>
                            <div [hidden]="brform.get('title').valid || (brform.get('title').pristine)"
                                class="text-danger">
                                <small *ngIf="brform.get('title').hasError('required')" class="error-label">
                                    {{getLang('titleisrequired', 'Title is required !')}}
                                </small>
                            </div>
                        </div>

                        <div class="col-md-3 membroz-col">
                            <label class="col-form-label">
                                {{getLang('days', 'Days')}}
                            </label>
                            <mat-form-field class="example-full-width">
                                <section class="example-section" appearance="standard">
                                    <mat-select matNativeControl multiple formControlName="days"
                                        placeholder="Choose day">
                                        <ng-container *ngFor="let day of wdoptions">
                                            <mat-option [value]="day.value" *ngIf="day.checked">
                                                <span> {{day?.value}}</span>
                                            </mat-option>
                                        </ng-container>
                                    </mat-select>
                                </section>
                            </mat-form-field>
                        </div>

                        <div class="col-md-3 membroz-col">
                            <label class="col-form-label">
                                {{getLang('starttime', 'Start Time')}}
                                <span class="text-danger">*</span>
                            </label>

                            <mat-form-field class="example-full-width">
                                <input matInput type="time" formControlName="starttime">
                                <mat-hint>{{getLang('hh:mm', 'HH:MM')}}</mat-hint>
                            </mat-form-field>

                            <div [hidden]="brform.get('starttime').valid || (brform.get('starttime').pristine)"
                                class="text-danger">
                                <small *ngIf="brform.get('starttime').hasError('required')" class="error-label">
                                    {{getLang('starttimeisrequired', 'Start time is required !')}}
                                </small>
                            </div>
                        </div>
                        <div class="col-md-3 membroz-col">
                            <label class="col-form-label">
                                {{getLang('endtime', 'End Time')}}
                                <span class="text-danger">*</span>
                            </label>

                            <mat-form-field class="example-full-width">
                                <input matInput type="time" formControlName="endtime">
                                <mat-hint>{{getLang('hh:mm', 'HH:MM')}}</mat-hint>
                            </mat-form-field>

                            <div [hidden]="brform.get('endtime').valid || (brform.get('endtime').pristine)"
                                class="text-danger">
                                <small *ngIf="brform.get('endtime').hasError('required')" class="error-label">
                                    {{getLang('endtimeisrequired', 'End time is required !')}}
                                </small>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-default" type="button" data-dismiss="modal" (click)="brform.reset()">
                        <i class="material-icons">close</i> {{getLang('cancel', 'Cancel')}}
                    </button>
                    <button class="btn btn-primary ml-2" type="submit">
                        <i class="material-icons">save</i> {{getLang('save', 'Save')}}
                    </button>
                </div>
            </div>
        </form>
    </div>
</div>